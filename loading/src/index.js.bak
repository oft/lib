module.exports = function createLoading(ele,autoDestory){
    var display = ele.tagName=="BODY"?"fixed":"absolute";
    var position = ele.style.position;
    var style = document.createElement("style");
    var box = document.createElement("div")

    ele.style.position = "relative";
    style.innerHTML = `
    .loading{ overflow: hidden; }
    .loading .loadingbox{ opacity:1; }
    `
    box.className="loadingbox";
    box.style = `transition: opacity 0.5s;
    background-color: #fff; 
    position: ${display};
    left:0;top:0;bottom:0;right:0;`
    box.innerHTML = `
    <div class="inner" style="transition: opacity 1s; opacity: 0; width: 58px; 
    height: 58px;position:${display};left:50%;top:50%;margin-left:-29px;margin-top:-29px;">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin:auto;background:#fff;display:block;" width="58px" height="58px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
        <g transform="translate(50 50)">  <g transform="translate(-19 -19) scale(0.6)"> <g>
        <animateTransform attributeName="transform" type="rotate" values="0;36" keyTimes="0;1" dur="0.25510204081632654s" begin="0s" repeatCount="indefinite"></animateTransform><path d="M30.775639009962486 22.290357635723915 L41.382240727760696 32.89695935352213 L32.89695935352213 41.382240727760696 L22.290357635723915 30.775639009962482 A38 38 0 0 1 11.796071485204802 36.122744877928895 L11.796071485204802 36.122744877928895 L14.142588460808266 50.93806998685596 L2.2903283736666054 52.81528356733873 L-0.05618860193685889 37.99995845841167 A38 38 0 0 1 -11.689194413177665 36.15747134370621 L-11.689194413177665 36.15747134370621 L-18.499051909270865 49.52256920653173 L-29.19113019953129 44.07468320965717 L-22.38127270343809 30.709585346831652 A38 38 0 0 1 -30.709585346831645 22.381272703438093 L-30.709585346831645 22.381272703438093 L-44.07468320965716 29.191130199531298 L-49.52256920653173 18.499051909270875 L-36.15747134370621 11.689194413177672 A38 38 0 0 1 -37.99995845841167 0.05618860193686587 L-37.99995845841167 0.05618860193686587 L-52.81528356733873 -2.290328373666595 L-50.93806998685596 -14.142588460808255 L-36.122744877928895 -11.796071485204795 A38 38 0 0 1 -30.77563900996249 -22.290357635723904 L-30.77563900996249 -22.290357635723904 L-41.3822407277607 -32.896959353522114 L-32.89695935352213 -41.38224072776069 L-22.290357635723915 -30.775639009962482 A38 38 0 0 1 -11.796071485204807 -36.122744877928895 L-11.796071485204807 -36.122744877928895 L-14.142588460808273 -50.93806998685596 L-2.290328373666611 -52.81528356733873 L0.05618860193685424 -37.99995845841167 A38 38 0 0 1 11.689194413177662 -36.15747134370621 L11.689194413177662 -36.15747134370621 L18.49905190927086 -49.52256920653173 L29.19113019953128 -44.074683209657174 L22.381272703438082 -30.709585346831656 A38 38 0 0 1 30.70958534683164 -22.381272703438096 L30.70958534683164 -22.381272703438096 L44.07468320965715 -29.1911301995313 L49.52256920653173 -18.499051909270882 L36.15747134370621 -11.689194413177676 A38 38 0 0 1 37.99995845841167 -0.056188601936870516 L37.99995845841167 -0.056188601936870516 L52.81528356733873 2.290328373666588 L50.93806998685596 14.142588460808248 L36.122744877928895 11.79607148520479 A38 38 0 0 1 30.77563900996249 22.2903576357239 M0 -23A23 23 0 1 0 0 23 A23 23 0 1 0 0 -23" fill="#6093f4"></path></g></g> <g transform="translate(19 19) scale(0.6)"> <g>
        <animateTransform attributeName="transform" type="rotate" values="36;0" keyTimes="0;1" dur="0.25510204081632654s" begin="-0.12755102040816327s" repeatCount="indefinite"></animateTransform><path d="M-30.77563900996249 -22.290357635723904 L-41.3822407277607 -32.896959353522114 L-32.89695935352213 -41.38224072776069 L-22.290357635723915 -30.775639009962482 A38 38 0 0 1 -11.796071485204807 -36.122744877928895 L-11.796071485204807 -36.122744877928895 L-14.142588460808273 -50.93806998685596 L-2.290328373666611 -52.81528356733873 L0.05618860193685424 -37.99995845841167 A38 38 0 0 1 11.689194413177662 -36.15747134370621 L11.689194413177662 -36.15747134370621 L18.49905190927086 -49.52256920653173 L29.19113019953128 -44.074683209657174 L22.381272703438082 -30.709585346831656 A38 38 0 0 1 30.70958534683164 -22.381272703438096 L30.70958534683164 -22.381272703438096 L44.07468320965715 -29.1911301995313 L49.52256920653173 -18.499051909270882 L36.15747134370621 -11.689194413177676 A38 38 0 0 1 37.99995845841167 -0.056188601936870516 L37.99995845841167 -0.056188601936870516 L52.81528356733873 2.290328373666588 L50.93806998685596 14.142588460808248 L36.122744877928895 11.79607148520479 A38 38 0 0 1 30.77563900996249 22.2903576357239 L30.77563900996249 22.2903576357239 L41.3822407277607 32.89695935352211 L32.896959353522135 41.38224072776069 L22.290357635723918 30.775639009962482 A38 38 0 0 1 11.796071485204811 36.12274487792889 L11.796071485204811 36.12274487792889 L14.142588460808279 50.93806998685595 L2.2903283736666187 52.81528356733873 L-0.05618860193684958 37.99995845841167 A38 38 0 0 1 -11.68919441317772 36.15747134370619 L-11.68919441317772 36.15747134370619 L-18.49905190927093 49.5225692065317 L-29.191130199531287 44.07468320965717 L-22.38127270343808 30.709585346831656 A38 38 0 0 1 -30.70958534683168 22.381272703438047 L-30.70958534683168 22.381272703438047 L-44.0746832096572 29.19113019953124 L-49.522569206531735 18.499051909270875 L-36.15747134370621 11.68919441317768 A38 38 0 0 1 -37.99995845841167 0.05618860193680767 L-37.99995845841167 0.05618860193680767 L-52.81528356733873 -2.290328373666663 L-50.93806998685596 -14.142588460808257 L-36.122744877928895 -11.796071485204786 A38 38 0 0 1 -30.775639009962457 -22.29035763572395 M0 -23A23 23 0 1 0 0 23 A23 23 0 1 0 0 -23" fill="#61713c"></path></g></g></g>
        </svg>
    </div>
    `
    ele.classList.add("loading");

    // 待元素已加载后，再改变透明度，采用 css3 动画效果 
    setTimeout(function(){
        ele.querySelector(".loadingbox > div").style.opacity=1;
    },0)

    
    ele.appendChild(style);
    ele.appendChild(box);
    
    return function(){
        //document.querySelector("#loading > div").style.opacity=0;
        ele.querySelector(".loadingbox").style.opacity = 0;
        setTimeout(function(){
        ele.style.position = position;
        box.remove();
        ele.classList.remove("loading")
        style.remove();
        style = null;
        position = null;
        box = null;
        ele = null;
        display = null;
        },500)
    }
}